We modify the abstraction in what we call a \emph{bounded abstraction}, so that
it refers to the abstract, and not the base, Petrinet and semantics.  This
bounded abstraction replaces base elements with corresponding bounded elements.
For example, if $A(S_1) = S$ and $A(S_2) = S$ ($S_1$ and $S_2$ are base
variables represented by $S$ in the abstraction), the transition rate associated with the $inf$ transition is
 ${\cal R}'({\bf p}', {\bf x}', z_{inf}) = \beta_1 S_1 I +  \beta_2 S_2 I$.
By construction, we know that $S_1 + S_2 = S$.  However, in general $\beta_1 \not=
\beta_2$, and we cannot say that $\beta_1 S_1 I + \beta_2 S_2 I = \beta S I$ for some definition of $\beta$.  Yet, if
we replace $\beta_1$ and $\beta_2$ by $\beta^{ub} = \max(\beta_1, \beta_2)$, then $\beta^{ub} S_1 I +
\beta^{ub} S_2 I \geq \beta S I$.  Simplifying, we get $\beta^{ub} S_1 I + \beta^{ub} S_2 I =
\beta^{ub}(S_1 + S_2)I = \beta^{ub} S I \geq \beta S I$.  A similar argument can be made for the lower bound where
$\beta^{lb} = \min(\beta_1, \beta_2)$ and we find that $\beta^{lb} S I \leq \beta S I$.  

By introducing the bounded parameters, we no longer rely upon the base state
variables or parameters.  However, in tracking the effect of the bounded
parameters, the bounded abstraction must also track bounded rates and bounded
state variables.  The resulting bounded abstraction thus over-approximates the
abstraction and base model, wherein we can derive bounds on the state variables
at each time, which may correspond to a larger (hence over-approximation) set of
state trajectories.

\begin{definition}
A bounded abstraction $(\Theta^B, \Omega^B)$ of an abstraction $(\Theta',
\Omega')$ of $(\Theta, \Omega)$ replaces each element of $(\Theta', \Omega')$ by
a pair of elements denoting the lower and upper bound of that element (and
referred to with the ``$lb$'' and ``$ub$'' superscripts).  The bounded
abstraction defines:
\begin{itemize}
    \item State: For each $x' \in X'$,  $x^{lb}, x^{ub} \in X^B$.  For each
    $v_{x'}' \in V_x'$, ${\cal X}^B(x^{lb}) = v_{x^{lb}}^B$ and ${\cal
    X}^B(x^{ub}) = v_{x^{ub}}^B$.   For each $x^{lb}, x^{ub} \in X^B$, ${\cal
    I}^B(x^{lb}) = {\cal I}^B(x^{ub}) = {\cal I}'(x')$.
        \item Parameters: For each $p' \in P'$, let ${\cal P}^B(p^{lb}) =
        \min\limits_{p \in P: A(p) = p'} {\cal P}(p)$ and ${\cal P}^B(p^{ub}) =
        \max\limits_{p \in P: A(p) = p'} {\cal P}(p)$. 
        

        \item Transitions: For each $z' \in Z'$, $z^{lb}, z^{ub} \in Z^B$. For
        each vertex $v_z \in V_z$, if $A(v_z)=v_z'$ then $v_{z^{lb}}^B, v_{z^{ub}}^B \in V_z^B$.
        
        \item In Edges: For each edge $(v_{z'}^B, v_{x'}^B) \in E_{in}'$,
        $(v_{z^{lb}}^B, v_{x^{lb}}^B), (v_{z^{ub}}^B, v_{x^{ub}}^B) \in E^B_{in}$.
        \item Out Edges: For each edge $(v_{x'}^B, v_{z'}^B) \in E_{out}'$,
        $(v_{x^{ub}}^B, v_{z^{lb}}^B), (v_{x^{lb}}^B, v_{z^{ub}}^B) \in E^B_{out}$.

        
        \item Transition Rates: For each $z^{lb} \in Z^B$, ${\cal R}^B({\bf
        p}^B, {\bf x}^B, z^{lb}) = \min\limits_{z \in Z: A(z)=z'} {\cal R}({\bf
        p}, {\bf x}, z)$ (replacing ${\bf p}$ and ${\bf x}$ of the minimal rate
        by the elements in ${\bf p}^B$ and ${\bf x}^B$ respectively, which
        minimize the rate), and ${\cal R}^B({\bf p}^B, {\bf x}^B, z^{ub}) =
        \max\limits_{z \in Z: A(z)=z'} {\cal R}({\bf p}, {\bf x}, z)$ (similarly
        replacing ${\bf p}$ and ${\bf x}$ of the maximal rate by the elements in
        ${\bf p}^B$ and ${\bf x}^B$ respectively, which maximize the rate).
\end{itemize}
    
\end{definition}

\begin{example}
    The bounded abstraction $(\Theta^B, \Omega^B)$ of the stratified SIR model
    defines:
    \begin{eqnarray*}
        V^B_x &=& \{v_{S}^{lb}, v_{S}^{ub}, v_{I}^{lb}, v_{I}^{ub},v_{R}^{lb},
        v_{R}^{ub},\}\\
        V^B_z &=& \{v_{inf}^{lb}, v_{inf}^{ub}, v_{rec}^{lb}, v_{rec}^{ub}\}\\
        E^B_{in} &=& ((v_{inf}^{lb}, v_{S}^{lb}), (v_{inf}^{lb},
        v_{I}^{lb}),(v_{inf}^{lb}, v_{I}^{lb}), (v_{rec}^{lb},
        v_{R}^{lb}),(v_{inf}^{ub}, v_{S}^{ub}), (v_{inf}^{ub},
        v_{I}^{ub}),(v_{inf}^{ub}, v_{I}^{ub}), (v_{rec}^{ub}, v_{R}^{ub})\\
        E^B_{out} &=& ((v_{S}^{lb}, v_{inf}^{ub}),(v_{I}^{lb}, v_{inf}^{ub}),
        (v_{I}^{lb}, v_{rec}^{ub}), (v_{S}^{ub}, v_{inf}^{lb}),(v_{I}^{ub},
        v_{inf}^{lb}), (v_{I}^{ub}, v_{rec}^{lb}))\\
        P^B &=& \{\beta^{lb}, \beta^{ub}, \gamma^{lb}, \gamma^{ub}\}\\
        X^B &=& \{S^{lb},  S^{ub}, I^{lb},I^{ub}, R^{lb},  R^{ub}\}\\
        Z^B &=& \{inf^{lb}, inf^{ub}, rec^{lb}, rec^{ub}\}\\
        {\cal I}^B &=& \left\{ 
            \begin{array}{ll}
                0.9& :S^{lb}\\
                0.9& :S^{ub}\\
                0.1& :I^{lb}\\
                0.1& :I^{ub}\\
                0.0& :R^{lb}\\
                0.0& :R^{ub} \end{array}\right.\\
        {\cal P}^B&=& \left\{ 
            \begin{array}{ll}
                1e{-7}& :\beta^{lb}\\
                2e{-7}& :\beta^{ub}\\
                1e{-5}& :\gamma^{lb}\\
                1e{-5}& :\gamma^{ub}\\
            \end{array}\right.\\
            \\
        {\cal X}^B &=& \left\{ 
            \begin{array}{ll}
                v^{lb}_{x} & : x^{lb} \in X^B\\
                v^{ub}_{x} & : x^{ub} \in X^B \end{array}\right.\\
        {\cal Z}^B &=& \left\{ 
            \begin{array}{ll}
                v_{z}^{lb} & : z^{lb} \in Z^B\\
                v_{z}^{ub} & : z^{ub} \in Z^B \end{array}\right.\\
        {\cal R}^{B} &=& \left\{ 
            \begin{array}{ll}
                \beta^{lb} S^{lb} I^{lb} & : z^{lb}_{inf}\\
                \beta^{ub} S^{ub} I^{ub} & : z^{ub}_{inf}\\
                \gamma^{lb} I^{lb}  & : z^{lb}_{rec}\\
                \gamma^{ub} I^{ub}  & : z^{ub}_{rec} \end{array}\right.\\
    \end{eqnarray*}

    The gradient for the bounded abstraction defines:
    \begin{eqnarray}
        \nabla_{\Theta^B, \Omega^B} = \begin{bmatrix} \frac{dS^{lb}}{dt}\\
                \frac{dS^{ub}}{dt}\\
                \frac{dI^{lb}}{dt}\\
                \frac{dI^{ub}}{dt}\\
                \frac{dR^{lb}}{dt}\\
                \frac{dR^{ub}}{dt} \end{bmatrix} = \begin{bmatrix} -{\cal
            R}^{B}({\bf p}^B, {\bf x}^B, z_{inf}^{ub})\\
            -{\cal R}^{B}({\bf p}^B, {\bf x}^B, z_{inf}^{lb})\\
             {\cal R}^{B}({\bf p}^B, {\bf x}^B, z_{inf}^{lb}) - {\cal
             R}^{B}({\bf p}^B, {\bf x}^B, z_{rec}^{ub})\\
             {\cal R}^{B}({\bf p}^B, {\bf x}^B, z_{inf}^{ub}) - {\cal
             R}^{B}({\bf p}^B, {\bf x}^B, z_{rec}^{lb})\\
             {\cal R}^{B}({\bf p}^B, {\bf x}^B, z_{rec}^{lb})\\
             {\cal R}^{B}({\bf p}^B, {\bf x}^B, z_{rec}^{ub}) \end{bmatrix} =
    \begin{bmatrix} -\beta^{ub} S^{ub} I^{ub}\\
        -\beta^{lb} S^{lb} I^{lb}\\
        \beta^{lb} S^{lb} I^{lb}-\gamma^{ub} I^{ub} \\
        \beta^{ub} S^{ub} I^{ub}-\gamma^{lb} I^{lb} \\
        \gamma^{lb} I^{lb}\\
        \gamma^{ub} I^{ub}
    \end{bmatrix} 
   \end{eqnarray}

\end{example}

% The bounded abstraction defines lower and upper bounds on the abstract state variables.  For example, we derive the upper bound on $\frac{dS}{dt}$ in Equation \ref{eqn:dsdt}:

% \begin{eqnarray*}
%     \frac{dS^{lb}}{dt} &\leq \frac{dS}{dt} &\leq \frac{dS^{ub}}{dt}\\
%     -\beta^{ub} S^{ub} I^{ub} &\leq \frac{dS}{dt} &\leq -\beta^{lb} S^{lb} I^{lb}\\
%     -\max(\beta_1, \beta_2) S^{ub} I^{ub} &\leq \frac{d (S_1+S_2)}{dt} &\leq -\min(\beta_1, \beta_2) S^{lb} I^{lb}\\
%     -\max(\beta_1, \beta_2) S^{ub} I^{ub} \leq -\max(\beta_1, \beta_2) (S_1+S_2) I^{ub} &\leq \frac{d S_1}{dt} +\frac{d S_2}{dt}&\leq -\min(\beta_1, \beta_2) (S_1+S_2) I^{lb}\leq -\min(\beta_1, \beta_2) S^{lb} I^{lb}\\
%     -\max(\beta_1, \beta_2) S^{ub} I^{ub} \leq -\max(\beta_1, \beta_2) (S_1+S_2) I^{ub} &\leq \frac{d S_1}{dt} +\frac{d S_2}{dt}&\leq -\min(\beta_1, \beta_2) (S_1+S_2) I\leq -\min(\beta_1, \beta_2) (S_1+S_2) I^{lb}\leq -\min(\beta_1, \beta_2) S^{lb} I^{lb}
% \end{eqnarray*}

% \begin{eqnarray}
%     \frac{dS}{dt} &=& \frac{d S_1}{dt} +\frac{d S_2}{dt} & Stratify: S\\
%     &=& -\beta_1 S_1 I  -   \beta_2 S_2 I& Stratified Rates\\
%     &\leq& -  \min(\beta_1, \beta_2)S_1 I - \min(\beta_1, \beta_2) S_2 I & Upper bound parameters\\
%     &=& - \min(\beta_1, \beta_2)(S_1 + S_2)I   & Factor: $-I \min(\beta_1, \beta_2) $ \\
%     &=& - \min(\beta_1, \beta_2)S I  & Abstract: ${\cal X}(S_1) = {\cal X}(S_2) = S$ \\
%     &\leq& - \beta^{ub}S^{ub}I^{ub}    & Bound \\
%     &=& \frac{d S^{ub}}{dt}\label{eqn:dsdt}
% \end{eqnarray}

% \begin{eqnarray*}
%     \frac{dI}{dt} &=& I S_1 \beta_1 + I S_2 \beta_2 - I\gamma & Stratified Rates\\
%     &\leq& I S_1 \max(\beta_1, \beta_2) + I S_2 \max(\beta_1, \beta_2) & Upper bound parameters\\
%     &=& I  \max(\beta_1, \beta_2)(S_1 + S_2)  & Factor: $I \max(\beta_1, \beta_2) $ \\
%     &=& I  S \max(\beta_1, \beta_2)  & Abstract: ${\cal X}(S_1) = {\cal X}(S_2) = S$ \\
%     &=& I  S\beta^{ub}  & Bound 
% \end{eqnarray*}

% \begin{eqnarray*}
%     \frac{d S^{lb}}{dt}= - \beta^{ub}S^{ub}I^{ub} \leq \frac{dS}{dt} &\leq& - \beta^{lb}S^{lb}I^{lb} = \frac{d S^{ub}}{dt}\\
%     \frac{d I^{lb}}{dt}=  \beta^{lb}S^{lb}I^{lb} - \gamma^{ub} I^{ub} \leq \frac{dI}{dt} &\leq& \beta^{ub}S^{ub}I^{ub}- \gamma^{lb} I^{lb} = \frac{d I^{ub}}{dt}\\
% \end{eqnarray*}